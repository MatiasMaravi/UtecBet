{% extends "bootstrap/base.html" %}

{% block title %}
Dashboard
{% endblock %}

{% block styles %}
{{super()}}
<link rel="stylesheet" href="{{url_for('.static', filename='css/dashboard.css')}}">
{% endblock %}


{% block content %}
      <nav class="navbar navbar-inverse navbar-fixed-top">
        <div class="container-fluid">
          <div class="navbar-header">
            <a class="navbar-brand" href="#">MATCHES TODAY</a>
          </div>
          <div id="navbar" class="navbar-collapse collapse">
            <ul class="nav navbar-nav navbar-right">
              {% if current_user.is_admin == True %}
              <li class="nav-item">
                <a class="nav-link" href="./admin">
                  Admin
                </a>
              </li>
              {% endif %}
              <li><a href="{{ url_for('logout') }}">Log Out</a></li>
            </ul>
          </div>
        </div>
      </nav>

        {% for match in matches %}     
          
            <div class = "Equipo1">
                <div class="example-local">{{match.local}}</div>
                <form id="Bet-create-local">
                    <input
                        type="number"
                        name="bet"
                        id="bet-local"
                        placeholder="Place your bet"
                    >
                    <input type="submit"class="btn btn-success" value="Bet"></input>
                </form>   
            </div>
            <div class = "Rival" id="userr" data-user="{{id_}}">
                <meta>Vs.</meta>
            </div>
            <div class = "Equipo2">
              <div class="example-visit"> {{match.visit}} </div>
                <form id="Bet-create-visit">
                    <input
                        type="number"
                        name="bet"
                        id="bet-visit"
                        placeholder="Place your bet"
                    >
                    <button type="submit" class="btn btn-success">Bet</button>
                </form>   
            </div>
            {% endfor %}
    <script>
            document.getElementById('Bet-create-local').onsubmit = function(event) {
                event.preventDefault();
                const monto = document.getElementById('bet-local').value;
                const collection = document.getElementsByClassName("example-local");
                const equipo = collection[0].innerHTML;
                var usuario = document.getElementById("userr").getAttribute("data-user");
                //const equipo = match.local;
                fetch('/create_bet', {
                    method: 'POST',
                    body: JSON.stringify({
                        'quota':1.5,
                        'bet_amount': monto,
                        'result':equipo,
                        'id_user':usuario,
                        'match_code':1
                    }),
                    headers: {
                        'Content-Type': 'application/json'
                    }
                })
            }
            document.getElementById('Bet-create-visit').onsubmit = function(event) {
                event.preventDefault();
                const monto = document.getElementById('bet-visit').value;
                const collection = document.getElementsByClassName("example-visit");
                const equipo = collection[0].innerHTML;
                
                //const equipo = match.local;
                fetch('/create_bet', {
                    method: 'POST',
                    body: JSON.stringify({
                        'quota':1.5,
                        'bet_amount': monto,
                        'result':equipo,
                        'id_user':1,
                        'match_code':1
                    }),
                    headers: {
                        'Content-Type': 'application/json'
                    }
                })
            }
    </script>
     
      {% endblock %}
</html>